{% extends "base.html" %}

{% block content %}
<!-- <div class="references-page"> -->
<!-- 레퍼런스 소개 섹션 -->
<section class="solution-intro-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <p class="mb-2 text-primary section-eyebrow">REFERENCES</p>
                <h1 class="section-title">
                    <span style="color: #FDB417;">엔클</span><span style="color: #828282;">은 최고의 팀과 솔루션으로</span><br>
                    최상의 성과물을 만들어냅니다
                </h1>
                <p class="lead">
                    엔클은 모두가 원팀이 되어 최고의 솔루션으로<br>
                    신속한 업무 처리와 세심한 품질 관리로 고객이 만족할 수 있는 결과를 제공합니다
                </p>
            </div>
        </div>
    </div>
</section>

<!-- Outputs 섹션 -->
<section class="section bg-light">
    <div class="container">
        <!-- Outputs 섹션 헤더 -->
        <div class="text-center mb-5">
            <p class="text-primary section-eyebrow">OUTPUTS</p>
            <p class="section-header-title mb-4">엔클의 성과물 사례</p>
            <p class="text-muted" style="font-size: 1.1rem;">엔클이 진행한 다양한 프로젝트의 성과물을 사례별로 확인할 수 있습니다</p>
        </div>
        
        <!-- Outputs 이미지 그리드 -->
         <div class="usecase-images">
             <!-- 상단 이미지 3개 -->
             <div class="row mb-2">
                <div class="col-md-4">
                    <div class="usecase-image-container no-crop">
                         <img src="{{ url_for('static', filename='assets/img/references/outputs_usecase_img_1.jpg') }}" alt="Outputs Usecase Image 1" class="img-fluid rounded usecase-image">
                         <div class="usecase-overlay">
                             <div class="usecase-text">
                                 <h5>주요 관광지 혼잡도 측정 방안 연구</h5>
                                 <p>• 과업목적: 혼잡도<br>
                                    • 과업기간: 2024.09 ~ 2024.12<br>
                                    • 발주기관: 한국관광공사</p>
                             </div>
                         </div>
                     </div>
                 </div>
                 <div class="col-md-4">
                     <div class="usecase-image-container no-crop">
                         <img src="{{ url_for('static', filename='assets/img/references/outputs_usecase_img_2.jpg') }}" alt="Outputs Usecase Image 2" class="img-fluid rounded usecase-image">
                         <div class="usecase-overlay">
                             <div class="usecase-text">
                                <h5>2024 소셜을 통한 주요 시장별 이슈 및 한국 관심 콘텐츠 분석</h5>
                                <p>• 과업목적: 빅데이터 분석<br>
                                   • 과업기간: 2024.04 ~ 2024.11<br>
                                   • 발주기관: 한국관광공사</p>
                             </div>
                         </div>
                     </div>
                 </div>
                 <div class="col-md-4">
                     <div class="usecase-image-container no-crop">
                         <img src="{{ url_for('static', filename='assets/img/references/outputs_usecase_img_3.jpg') }}" alt="Outputs Usecase Image 3" class="img-fluid rounded usecase-image">
                         <div class="usecase-overlay">
                             <div class="usecase-text">
                                <h5>지역 관광활성화 진단도구 및 시각화 서비스 강화 연구</h5>
                                <p>• 과업목적: 빅데이터 분석<br>
                                   • 과업기간: 2023.09 ~ 2023.12<br>
                                   • 발주기관: 한국관광공사</p>
                             </div>
                         </div>
                     </div>
                 </div>
             </div>

             <!-- 하단 이미지 3개 -->
             <div class="row mb-2">
                <div class="col-md-4">
                    <div class="usecase-image-container no-crop">
                        <img src="{{ url_for('static', filename='assets/img/references/outputs_usecase_img_4.jpg') }}" alt="Outputs Usecase Image 4" class="img-fluid rounded usecase-image">
                        <div class="usecase-overlay">
                            <div class="usecase-text">
                                <h5>웰니스관광산업 육성을 위한 전략수립 및 과제발굴 기획연구</h5>
                                <p>• 과업목적: 전략수립<br>
                                   • 과업기간: 2023.11 ~ 2023.12<br>
                                   • 발주기관: 한국관광공사</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="usecase-image-container no-crop">
                        <img src="{{ url_for('static', filename='assets/img/references/outputs_usecase_img_5.jpg') }}" alt="Outputs Usecase Image 5" class="img-fluid rounded usecase-image">
                        <div class="usecase-overlay">
                            <div class="usecase-text">
                                <h5>서울형 관광지표개발 연구</h5>
                                <p>• 과업목적: 지표개발<br>
                                   • 과업기간: 2022.10 ~ 2022.12<br>
                                   • 발주기관: 서울관광재단</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="usecase-image-container no-crop">
                        <img src="{{ url_for('static', filename='assets/img/references/outputs_usecase_img_6.jpg') }}" alt="Outputs Usecase Image 6" class="img-fluid rounded usecase-image">
                        <div class="usecase-overlay">
                            <div class="usecase-text">
                                <h5>경기도 워케이션 허브 구축 타당성 검토 연구</h5>
                                <p>• 과업목적: 성과분석<br>
                                   • 과업기간: 2023.06 ~ 2023.08<br>
                                   • 발주기관: 경기도경제과학진흥원</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- 레퍼런스 섹션 -->
<section class="section">
    <div class="container">
        <!-- 레퍼런스 projects 섹션 헤더 -->
        <div class="text-center mb-5">
            <p class="text-primary section-eyebrow">PROJECTS</p>
            <p class="section-header-title mb-4">ENCLE의 성과물</p>
            <p class="text-muted" style="font-size: 1.1rem;">엔클이 진행한 다양한 프로젝트의 성과물을 연도별로 확인할 수 있습니다</p>
        </div>

        <!-- 연도 필터 -->
        <div class="row mb-4">
            <div class="col-lg-12 text-center">
                <div class="year-filter">
                    <button class="btn btn-outline-primary year-filter-btn {% if not selected_year %}active{% endif %}" 
                            data-year="all">
                        전체
                    </button>
                    <button class="btn btn-outline-primary year-filter-btn {% if selected_year == '2025' %}active{% endif %}" 
                            data-year="2025">
                        2025
                    </button>
                    <button class="btn btn-outline-primary year-filter-btn {% if selected_year == '2024' %}active{% endif %}" 
                            data-year="2024">
                        2024
                    </button>
                    <button class="btn btn-outline-primary year-filter-btn {% if selected_year == '2023' %}active{% endif %}" 
                            data-year="2023">
                        2023
                    </button>
                    <button class="btn btn-outline-primary year-filter-btn {% if selected_year == '2022' %}active{% endif %}" 
                            data-year="2022">
                        2022
                    </button>
                </div>
            </div>
        </div>

        <!-- 레퍼런스 테이블 -->
        <div class="row">
            <div class="col-lg-12" id="references-table-container">
                {% include 'references/_references_table.html' %}
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 연도 필터 버튼 클릭 이벤트
    document.querySelectorAll('.year-filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const year = this.getAttribute('data-year');
            
            // 활성 버튼 스타일 변경
            document.querySelectorAll('.year-filter-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // AJAX 요청
            loadReferences(year, 1);
        });
    });
    
    // 페이징 클릭 이벤트 (이벤트 위임 사용)
    document.addEventListener('click', function(e) {
        if (e.target.closest('.pagination .page-link')) {
            e.preventDefault();
            const link = e.target.closest('.pagination .page-link');
            const page = link.getAttribute('data-page');
            const year = link.getAttribute('data-year');
            
            if (page && year) {
                loadReferences(year, page);
            }
        }
    });
    
    // AJAX로 레퍼런스 로드
    function loadReferences(year, page) {
        const container = document.getElementById('references-table-container');
        
        // 로딩 표시
        container.innerHTML = '<div class="text-center py-5"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div></div>';
        
        // AJAX 요청
        fetch(`/references/api/filter?year=${year}&page=${page}`)
            .then(response => response.json())
            .then(data => {
                container.innerHTML = data.table_html;
                
                // URL 업데이트 (브라우저 히스토리)
                const url = new URL(window.location);
                if (year !== 'all') {
                    url.searchParams.set('year', year);
                } else {
                    url.searchParams.delete('year');
                }
                if (page > 1) {
                    url.searchParams.set('page', page);
                } else {
                    url.searchParams.delete('page');
                }
                window.history.pushState({}, '', url);
            })
            .catch(error => {
                console.error('Error:', error);
                container.innerHTML = '<div class="text-center py-5"><div class="alert alert-danger">데이터를 불러오는 중 오류가 발생했습니다.</div></div>';
            });
    }
});
</script>
</div>
{% endblock %}